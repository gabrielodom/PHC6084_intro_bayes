<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Odom, Kazi Tanvir Hasan, and Ning Sun">
<meta name="dcterms.date" content="2022-11-02">

<title>Lesson 7: Introduction to Loss Functions and Decision Theory</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="lesson_07_loss_functions_files/libs/clipboard/clipboard.min.js"></script>
<script src="lesson_07_loss_functions_files/libs/quarto-html/quarto.js"></script>
<script src="lesson_07_loss_functions_files/libs/quarto-html/popper.min.js"></script>
<script src="lesson_07_loss_functions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lesson_07_loss_functions_files/libs/quarto-html/anchor.min.js"></script>
<link href="lesson_07_loss_functions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lesson_07_loss_functions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lesson_07_loss_functions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lesson_07_loss_functions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lesson_07_loss_functions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 7: Introduction to Loss Functions and Decision Theory</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel Odom, Kazi Tanvir Hasan, and Ning Sun </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 2, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>TO TANVIR AND NING: DO NOT EDIT</p>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Loss functions augment our ability to make decisions. At the most basic level, <strong>loss functions</strong> quantify the penalty we pay if we make a bad <strong>decision</strong>. A basic example is this: we flip a coin with probability of Heads <span class="math inline">\(p\)</span>; if we flip a Head, then I pay you 1 dollar; if we flip a Tail, then you pay me 1 dollar. We may or may not have some data, <span class="math inline">\(\textbf{x}\)</span>, of previous flips of this coin. There are two <strong>decisions</strong> you can make, denoted <span class="math inline">\(d(\textbf{x})\)</span>: 1) play the game, or 2) do not play the game. The loss function for the next flip, <span class="math inline">\(x^*\)</span> would be</p>
<p><span class="math display">\[
\ell(p|d(\textbf{x})) = \begin{cases}
  +1, &amp; x^* = H \\
  -1, &amp; x^* \ne H
\end{cases} .
\]</span></p>
</section>
<section id="common-loss-functions" class="level1">
<h1>Common Loss Functions</h1>
<p>There are a few “standard” loss functions in basic decision theory: absolute error loss, hinge loss, squared (or some higher polynomial) error loss, and 0-1 loss. For the sake of simplicity, assume we are have an estimate <span class="math inline">\(d(\textbf{x}) = a\)</span> for a parameter <span class="math inline">\(\theta \in \mathbb{R}\)</span>.</p>
<ul>
<li>Absolute Error Loss: <span class="math inline">\(\ell(\theta|a) = |\theta - a|\)</span>. Explanation: the penalty for making a bad decision (a bad value for <span class="math inline">\(a\)</span>) increases linearly as the estimate for <span class="math inline">\(\theta\)</span> gets worse <em>in either direction</em>.</li>
<li>Hinge Error Loss: <span class="math inline">\(\ell(\theta|a) = \{\theta - a,\ a \le \theta;\ 0,\ a &gt; \theta\)</span> OR <span class="math inline">\(\ell(\theta|a) = \{a - \theta,\ a \ge \theta;\ 0,\ a &lt; \theta\)</span>. Explanation: the penalty for making a bad decision (a bad value for <span class="math inline">\(a\)</span>) increases linearly as the estimate for <span class="math inline">\(\theta\)</span> gets worse <em>in only one direction</em>.</li>
<li>Squared (Polynomial) Error Loss: <span class="math inline">\(\ell(\theta|a) = (\theta - a)^2\)</span>. Explanation: the penalty for making a bad decision (a bad value for <span class="math inline">\(a\)</span>) <em>accelerates</em> as the estimate for <span class="math inline">\(\theta\)</span> gets worse in either direction. We can replace the power of 2 with any value <span class="math inline">\(k &gt; 1\)</span> and get the same result, but with differing rates of acceleration.</li>
<li>0-1 Loss: <span class="math inline">\(\ell(\theta|a) = \{1,\ a \ne \theta;\ 0,\ a = \theta\)</span>. Explanation: if we guess parameter exactly right, there is no penalty; if we make any mistake at all—no matter how small—we lose. A variant of this is to specify an allowable set of values for <span class="math inline">\(a\)</span>, <span class="math inline">\(\mathcal{X}\)</span>, and we assign a loss of 0 <span class="math inline">\(\forall a \in \mathcal{X}\)</span> and 1 otherwise.</li>
</ul>
</section>
<section id="loss-in-the-bayes-paradigm" class="level1">
<h1>Loss in the Bayes Paradigm</h1>
<p>What we see above is the loss for a single decision, based on some (or no) prior data. In most cases, we care less about the loss of a single next step, but rather the average, or <strong>expected</strong>, loss based on all available information about the parameter of interest. All of our information is, by definition, represented in the compact form of the posterior distribution. The posterior distribution for a parameter condenses all our prior information and data collected about the parameter into a single probability function.</p>
<p>Given a posterior distribution <span class="math inline">\(\pi(\theta|\textbf{x})\)</span> and a loss function <span class="math inline">\(\ell(p|d(\textbf{x}))\)</span>, the average/expected loss, also known as the <strong>risk</strong>, is given by <span class="math display">\[
r(\theta, d(\textbf{x})) \equiv \int \ell(\theta|d(\textbf{x})) \times \pi(\theta|\textbf{x}) d\theta.
\]</span></p>
<p>Further note that if the loss function is chosen <em>a priori</em> (that is, independent of the observed data), then <span class="math display">\[
\begin{align}
r(\theta, d(\theta))) &amp;\equiv \int \ell(\theta|d(\theta)) \times \pi(\theta|\textbf{x}) d\theta \\
&amp;= \int \ell(\theta|d(\theta)) \times \frac{\mathcal{L}(\theta|\textbf{x})\pi(\theta)}{\int \mathcal{L}(\theta|\textbf{x})\pi(\theta)d\theta} d\theta \\
&amp;= \int \frac{\mathcal{L}(\theta|\textbf{x})\pi(\theta)\ell(\theta|d(\theta))}{\int \mathcal{L}(\theta|\textbf{x})\pi(\theta)d\theta} d\theta,
\end{align}
\]</span> which simply includes the loss function as a <em>prior constraint</em> on the parameter <span class="math inline">\(\theta\)</span>.</p>
<p>A few key points:</p>
<ul>
<li>Under <em>absolute error loss</em>, the parameter value for <span class="math inline">\(a\)</span> that minimizes this loss is the posterior <em>median</em>.</li>
<li>Under <em>squared error loss</em>, the parameter value for <span class="math inline">\(a\)</span> that minimizes this loss is the posterior <em>mean</em>. Under <em>0-1 loss</em>, the parameter value for <span class="math inline">\(a\)</span> that minimizes this loss is the posterior <em>mode</em>.</li>
</ul>
</section>
<section id="assignment" class="level1">
<h1>Assignment</h1>
<ul>
<li>Read and comment your thoughts on <a href="https://www.stat.purdue.edu/~dasgupta/528-8.pdf">Brown (2000)</a>.</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>